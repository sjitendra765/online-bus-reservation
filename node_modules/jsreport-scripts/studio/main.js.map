{"version":3,"sources":["webpack:///webpack/bootstrap 59d09128f54b2b3a192b","webpack:///./studio/main_dev.js","webpack:///./studio/ScriptEditor.js","webpack:///external \"Studio.libraries['react']\"","webpack:///external \"Studio\"","webpack:///./studio/ScriptProperties.js"],"names":[],"mappings":"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","file":"./studio/main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 59d09128f54b2b3a192b\n **/","import ScriptEditor from './ScriptEditor.js'\r\nimport Properties from './ScriptProperties.js'\r\nimport Studio from 'jsreport-studio'\r\n\r\nStudio.addEntitySet({ name: 'scripts', faIcon: 'fa-cogs', visibleName: 'script', helpUrl: 'http://jsreport.net/learn/scripts' })\r\nStudio.addPropertiesComponent(Properties.title, Properties, (entity) => entity.__entitySet === 'templates')\r\n\r\nStudio.addEditorComponent('scripts', ScriptEditor, (reformatter, entity) => ({ content: reformatter(entity.content, 'js') }))\r\n\r\nStudio.addApiSpec({\r\n  template: {\r\n    scripts: [{\r\n      shortid: '...',\r\n      content: 'function beforeRender...'\r\n    }]\r\n  }\r\n})\r\n\r\nStudio.previewListeners.push((request, entities) => {\r\n  if (!request.template.scripts) {\r\n    return\r\n  }\r\n\r\n  request.template.scripts = request.template.scripts.map((s) => {\r\n    const script = Studio.getEntityByShortid(s.shortid, false)\r\n\r\n    if (!script) {\r\n      return s\r\n    }\r\n\r\n    return script\r\n  }).filter((s) => !s.__isNew || s.content)\r\n})\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./studio/main_dev.js\n **/","import React, { Component } from 'react'\r\nimport { TextEditor } from 'jsreport-studio'\r\n\r\nexport default class ScriptEditor extends Component {\r\n  static propTypes = {\r\n    entity: React.PropTypes.object.isRequired,\r\n    onUpdate: React.PropTypes.func.isRequired\r\n  }\r\n\r\n  render () {\r\n    const { entity, onUpdate } = this.props\r\n\r\n    return (<TextEditor\r\n      name={entity._id}\r\n      mode='javascript'\r\n      value={entity.content}\r\n      onUpdate={(v) => onUpdate(Object.assign({}, entity, {content: v}))}\r\n      />)\r\n  }\r\n}\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./studio/ScriptEditor.js\n **/","module.exports = Studio.libraries['react'];\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"Studio.libraries['react']\"\n ** module id = 2\n ** module chunks = 0\n **/","module.exports = Studio;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"Studio\"\n ** module id = 3\n ** module chunks = 0\n **/","import React, { Component } from 'react'\r\n\r\nexport default class ScriptProperties extends Component {\r\n  selectScripts (entities) {\r\n    return Object.keys(entities).filter((k) => entities[k].__entitySet === 'scripts').map((k) => entities[k])\r\n  }\r\n\r\n  static getSelectedScripts (entity, entities) {\r\n    const getName = (s) => {\r\n      const foundScripts = Object.keys(entities).map((k) => entities[k]).filter((sc) => sc.shortid === s.shortid)\r\n\r\n      return foundScripts.length ? foundScripts[0].name : ''\r\n    }\r\n\r\n    return (entity.scripts || []).map((s) => ({\r\n      ...s,\r\n      name: getName(s)\r\n    }))\r\n  }\r\n\r\n  renderOrder () {\r\n    const scripts = ScriptProperties.getSelectedScripts(this.props.entity, this.props.entities)\r\n\r\n    return <span>{scripts.map((s) => <span key={s.shortid}>{s.name + ' '}</span>)}</span>\r\n  }\r\n\r\n  componentDidMount () {\r\n    this.removeInvalidScriptReferences()\r\n  }\r\n\r\n  componentDidUpdate () {\r\n    this.removeInvalidScriptReferences()\r\n  }\r\n\r\n  static title (entity, entities) {\r\n    if (!entity.scripts || !entity.scripts.length) {\r\n      return 'scripts'\r\n    }\r\n\r\n    return 'scripts: ' + ScriptProperties.getSelectedScripts(entity, entities).map((s) => s.name).join(', ')\r\n  }\r\n\r\n  removeInvalidScriptReferences () {\r\n    const { entity, entities, onChange } = this.props\r\n\r\n    if (!entity.scripts) {\r\n      return\r\n    }\r\n\r\n    const updatedScripts = entity.scripts.filter((s) => Object.keys(entities).filter((k) => entities[k].__entitySet === 'scripts' && entities[k].shortid === s.shortid).length)\r\n\r\n    if (updatedScripts.length !== entity.scripts.length) {\r\n      onChange({ _id: entity._id, scripts: updatedScripts })\r\n    }\r\n  }\r\n\r\n  render () {\r\n    const { entity, entities, onChange } = this.props\r\n    const scripts = this.selectScripts(entities)\r\n\r\n    const selectValues = (event, ascripts) => {\r\n      const el = event.target\r\n      let scripts = Object.assign([], ascripts)\r\n\r\n      for (var i = 0; i < el.options.length; i++) {\r\n        if (el.options[i].selected) {\r\n          if (!scripts.filter((s) => s.shortid === el.options[i].value).length) {\r\n            scripts.push({ shortid: el.options[i].value })\r\n          }\r\n        } else {\r\n          if (scripts.filter((s) => s.shortid === el.options[i].value).length) {\r\n            scripts = scripts.filter((s) => s.shortid !== el.options[i].value)\r\n          }\r\n        }\r\n      }\r\n\r\n      return scripts\r\n    }\r\n\r\n    return (\r\n      <div className='properties-section'>\r\n        <div className='form-group'>\r\n          <select title='Use CTRL to deselect item and also to select multiple options. The order of selected scripts is reflected on the server'\r\n            multiple size='7' value={entity.scripts ? entity.scripts.map((s) => s.shortid) : []}\r\n            onChange={(v) => onChange({_id: entity._id, scripts: selectValues(v, entity.scripts)})}>\r\n            {scripts.map((s) => <option key={s.shortid} value={s.shortid}>{s.name}</option>)}\r\n          </select>\r\n          {(entity.scripts && entity.scripts.length) ? <div><span>Run order:</span>{this.renderOrder()}</div> : <div />}\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./studio/ScriptProperties.js\n **/"],"sourceRoot":""}